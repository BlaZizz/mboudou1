<html>

<style>

a {
color: orange;
}

</style>

<script src="https://mboudou-developer-edition.eu40.force.com/lightning/lightning.out.js"></script>
<script type="text/javascript" src="jquery.js"> </script> 
<script type="text/javascript" src="jqueryCookies.js"> </script> 
  

<div data-lightning-out="true"></div>

<script>

const appName = 'c:OptOutFromWrapper';
const componentName = 'c:outOptForm';
const lightningEndpoint = 'https://mboudou-developer-edition.eu40.force.com';
const targetElement = document.querySelector("[data-lightning-out]");
const componentAttributes = {

};

var _lightningReady = false;
if(!$.cookie("AccToken"))
{ 
  console.log('Il faut se connecter');
alert("Login to Salesforce First!!!");
}

if (_lightningReady) {
  console.log('Je suis dans le lightningready');
		if (typeof callback === "function") {
      console.log('Je suis dans le callback');
			callback();
		}
	} else {
	    // Transform the URL for Lightning
    console.log('je transforme');
	    var url = $.cookie("InstURL");
		url = url.replace("my.salesforce", "lightning.force");  
  
    $Lightning.use(
          appName,
          function (){
            $Lightning.createComponent(
                    componentName,
                    componentAttributes,
                    targetElement,
                    function (cmp){
                      console.log('lightning component created');
                    }
            );
          }, url, $.cookie("AccToken")
	    lightningEndpoint
  );
	}

</script>


</html>
